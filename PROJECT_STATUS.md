# Accounting 项目功能清单

## ✅ 已实现功能

### 1. 核心数据模型
- ✅ **ExpenseItem（账单）**: 金额、标题、日期、分类、账户
- ✅ **Category（分类）**: 名称、图标、颜色、类型（收入/支出）
- ✅ **Account（账户）**: 名称、余额、类型、图标、颜色
- ✅ **数据持久化**: 使用 SwiftData 进行本地存储
- ✅ **默认数据初始化**: 自动创建默认分类和账户

### 2. 主要界面（4个Tab）

#### Tab 1: 时间线（TimelineView）
- ✅ 显示当月所有账单，按日期分组
- ✅ 顶部显示月度总支出卡片
- ✅ 账单列表展示（日期、分类、金额、账户）
- ✅ 支持删除账单（长按或上下文菜单）
- ✅ 删除账单时自动恢复账户余额
- ✅ 双击Tab栏滚动到顶部

#### Tab 2: 分析（AnalysisView）
- ✅ 时间段选择器（本周/本月/本年）
- ✅ 总支出统计卡片
- ✅ 平均支出、最大支出统计
- ✅ 分类支出饼图（按金额占比）
- ✅ 趋势折线图（按时间段）
- ✅ 分类支出列表（Top 5）

#### Tab 3: 统计（StatisticsView）
- ✅ 收入和支出分别统计
- ✅ 时间段选择器（本周/本月/本年）
- ✅ 收入/支出卡片展示
- ✅ 分类统计图表
- ✅ 趋势图表（支持周/月/年视图）
- ✅ 自定义日期格式化（中文）

#### Tab 4: 资产（AssetsView）
- ✅ 总净资产、总资产、总负债统计
- ✅ 账户列表展示（卡片式）
- ✅ 添加账户功能
- ✅ 编辑账户（名称、类型、颜色、图标）
- ✅ 调整账户余额（自动创建交易记录）
- ✅ 账户间转账功能
- ✅ 删除账户功能
- ✅ 长按账户卡片显示操作菜单

#### Tab 5: 设置（SettingsView）
- ✅ 连续使用天数统计（Streak）
- ✅ iCloud 同步开关（UI）
- ✅ 导出到 CSV（占位符）
- ✅ 导入数据（占位符视图）
- ✅ Face ID 解锁开关（UI）
- ✅ 应用图标设置（占位符视图）
- ✅ 用户昵称设置
- ✅ 分类管理入口
- ✅ 重置所有数据功能（带确认对话框）
- ✅ 应用版本显示
- ✅ 评价应用按钮（占位符）

### 3. 快速添加功能
- ✅ 底部中央快速添加按钮
- ✅ 分类选择页面（CategorySelectionSheet）
- ✅ 金额输入页面（QuickAddSheet）
  - ✅ 两种输入模式：直接输入金额 / 计算器模式
  - ✅ 自定义数字键盘
  - ✅ 表达式计算（+、-、×、÷）
  - ✅ 描述输入
  - ✅ 支付方式选择（账户选择器）
  - ✅ 自动更新账户余额（支出减少，收入增加）

### 4. 分类管理（CategoryManagementView）
- ✅ 分类列表展示（支出/收入分组）
- ✅ 添加分类功能
- ✅ 编辑分类功能（名称、类型、颜色、图标）
- ✅ 删除分类功能
- ✅ 图标快捷选择器
- ✅ 颜色选择器
- ✅ 分类预览

### 5. 账户服务（AccountService）
- ✅ 余额调整服务（自动创建交易记录保持账本一致性）
- ✅ 转账功能
- ✅ 账户余额自动更新（创建/删除账单时）

### 6. 数据管理
- ✅ 默认数据初始化（DataSeeder）
  - ✅ 默认支出分类（餐饮、交通、购物、住房、娱乐、医疗等）
  - ✅ 默认收入分类（工资、奖金、投资、兼职等）
  - ✅ 默认账户（微信支付、支付宝、银行卡、现金、信用卡）
- ✅ 重置所有数据功能
- ✅ 模拟数据清理（已移除）

### 7. UI/UX 特性
- ✅ 自定义 Tab Bar（底部导航栏）
- ✅ 渐变背景卡片
- ✅ 现代化 UI 设计
- ✅ 中文界面
- ✅ 响应式布局
- ✅ 动画效果
- ✅ 阴影和圆角设计

### 8. iCloud 同步（部分完成）
- ✅ 代码层面已配置 CloudKit
- ✅ ModelContainer 配置 `cloudKitDatabase: .automatic`
- ⚠️ 需要手动完成 Xcode 配置（详见 ICLOUD_SYNC_SETUP.md）

---

## 🚧 未实现功能（占位符）

### 1. 数据导出/导入
- ✅ **CSV 导出**: 已实现完整功能（支持 Excel 兼容、BOM、字段转义）
- ❌ **数据导入**: 仅占位符视图，未实现实际功能

### 2. 安全功能
- ❌ **Face ID 解锁**: UI 开关存在，但未实现实际解锁逻辑

### 3. 个性化
- ❌ **应用图标设置**: 仅占位符视图，未实现实际功能

### 4. 应用商店
- ❌ **评价应用**: 按钮存在，但未实现跳转到 App Store

---

## 💡 可以开发的功能建议

### 高优先级功能

#### 1. 预算管理
- 设置月度/年度预算
- 预算进度显示
- 预算超支提醒
- 分类预算设置

#### 2. 账单搜索
- 全局搜索账单
- 按分类、日期、金额筛选
- 高级筛选条件（多条件组合）

#### 3. 数据备份与恢复
- 本地备份文件（JSON/CSV）
- 从备份文件恢复数据
- 自动备份提醒

#### 4. 定期账单
- 设置定期账单（如月租、订阅）
- 自动创建账单记录
- 定期账单管理

#### 5. 账单详情编辑
- 编辑已有账单（金额、分类、日期、账户）
- 账单备注/标签
- 账单照片附件

### 中优先级功能

#### 6. 报表生成
- 月度/年度报表
- PDF 导出
- 邮件分享报表

#### 7. 多币种支持
- 支持多种货币
- 汇率转换
- 多币种账户

#### 8. 标签系统
- 为账单添加多个标签
- 按标签筛选和统计
- 标签管理

#### 9. 账单提醒
- 设置账单提醒（如还款日）
- 推送通知
- 提醒历史记录

#### 10. 数据统计增强
- 同比/环比分析
- 支出趋势预测
- 分类支出占比变化
- 年度对比图表

### 低优先级功能

#### 11. 账单分享
- 分享账单到其他应用
- 生成账单图片
- 账单链接分享

#### 12. 主题设置
- 深色模式支持
- 自定义主题颜色
- 字体大小设置

#### 13. 快捷操作
- 3D Touch / Haptic Touch 快捷菜单
- Widget 小组件
- Siri 快捷指令

#### 14. 数据可视化增强
- 更多图表类型（柱状图、散点图）
- 交互式图表
- 图表导出为图片

#### 15. 社交功能
- 家庭成员共享账本（需要后端支持）
- 账单评论/备注
- 支出排行榜（匿名）

#### 16. 智能功能
- AI 分类建议
- 异常支出检测
- 消费习惯分析
- 智能记账（OCR 识别小票）

#### 17. 其他
- 账单模板（常用账单快速创建）
- 账单重复功能
- 账单分组（如旅行、项目）
- 导出格式多样化（Excel、PDF、JSON）

---

## 📊 技术栈

- **语言**: Swift
- **UI 框架**: SwiftUI
- **数据持久化**: SwiftData
- **云同步**: CloudKit（已配置，需手动完成 Xcode 设置）
- **图表**: Swift Charts
- **最低支持**: iOS 17+（SwiftData 要求）

---

## 🔧 已知问题

1. **iCloud 同步**: 代码已配置，但需要在 Xcode 中手动完成 Capabilities 配置
2. **CSV 导出**: 功能未实现，仅占位符
3. **数据导入**: 功能未实现，仅占位符视图
4. **Face ID**: UI 存在，但未实现实际解锁逻辑
5. **应用图标设置**: 功能未实现，仅占位符视图

---

## 📝 开发建议

### 短期目标（1-2周）
1. 实现 CSV 导出功能
2. 实现数据导入功能
3. 完成 Face ID 解锁功能
4. 修复已知 bug

### 中期目标（1-2月）
1. 实现预算管理功能
2. 实现账单搜索功能
3. 实现数据备份/恢复
4. 实现定期账单功能

### 长期目标（3-6月）
1. 多币种支持
2. 报表生成
3. Widget 小组件
4. Siri 快捷指令

---

**最后更新**: 2024年（根据代码分析）
